---
phase: 05.5-resto360-lite
plan: 03
type: execute
wave: 2
depends_on: ["05.5-01"]
files_modified:
  - apps/web/app/[locale]/register/page.tsx
  - apps/web/app/[locale]/onboarding/page.tsx
  - apps/web/components/onboarding/StepIndicator.tsx
  - apps/web/components/onboarding/RestaurantDetailsStep.tsx
  - apps/web/components/onboarding/CategoryStep.tsx
  - apps/web/components/onboarding/MenuItemStep.tsx
  - apps/web/components/onboarding/QRCodeStep.tsx
  - apps/web/lib/hooks/useOnboarding.ts
  - apps/web/messages/fr.json
  - apps/web/messages/en.json
autonomous: true

must_haves:
  truths:
    - "User can complete registration form"
    - "Registration redirects to onboarding wizard"
    - "Wizard has 4 steps: details, category, menu item, QR code"
    - "User can download QR code in multiple sizes"
    - "User can complete onboarding in under 5 minutes"
  artifacts:
    - path: "apps/web/app/[locale]/register/page.tsx"
      provides: "Registration form"
      contains: "register"
    - path: "apps/web/app/[locale]/onboarding/page.tsx"
      provides: "Onboarding wizard composition"
      min_lines: 50
    - path: "apps/web/components/onboarding/QRCodeStep.tsx"
      provides: "QR code download"
      contains: "download"
  key_links:
    - from: "apps/web/app/[locale]/register/page.tsx"
      to: "/api/auth/register/"
      via: "fetch POST"
      pattern: "fetch.*register"
    - from: "apps/web/components/onboarding/QRCodeStep.tsx"
      to: "/menu/[slug]"
      via: "QR code URL"
      pattern: "menu.*slug"
---

<objective>
Create registration page and 4-step onboarding wizard that guides new users from signup to live QR menu.

Purpose: Enable "menu online in 5 minutes" promise by providing streamlined signup and guided setup flow.

Output: Registration form that creates account and redirects to wizard, 4-step onboarding (details, category, menu item, QR download), completion state that launches user into lite dashboard.
</objective>

<execution_context>
@C:\Users\dell\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\dell\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/05.5-resto360-lite/05.5-CONTEXT.md
@.planning/phases/05.5-resto360-lite/05.5-01-SUMMARY.md

# API patterns
@apps/api/apps/authentication/views.py
# Existing menu API for creating categories/items
@apps/api/apps/menu/views.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create registration page</name>
  <files>
    apps/web/app/[locale]/register/page.tsx
    apps/web/messages/fr.json
    apps/web/messages/en.json
  </files>
  <action>
Create registration page at /register:

**Form fields:**
- Restaurant name (required)
- Phone number (required, with country code hint +225)
- Email (required)
- Password (required, min 8 chars)
- Confirm password (required)

**Behavior:**
1. Client-side validation (password match, required fields)
2. On submit, POST to /api/auth/register/
3. On success:
   - Store JWT tokens (access in memory, refresh in httpOnly cookie or secure storage)
   - Redirect to /onboarding
4. On error, display error messages inline

**UI:**
- Centered card layout
- Emerald accent colors (consistent with landing)
- Link to login page for existing users
- "Already have an account? Log in" at bottom

**Translations:**
Add to messages files:
```json
"register": {
  "title": "Create your free menu",
  "restaurant_name": "Restaurant name",
  "phone": "Phone number",
  "email": "Email",
  "password": "Password",
  "password_confirm": "Confirm password",
  "submit": "Create account",
  "login_link": "Already have an account?",
  "login_cta": "Log in",
  "errors": {
    "password_mismatch": "Passwords do not match",
    "required": "This field is required"
  }
}
```

Use existing API client pattern from the codebase.
  </action>
  <verify>
    npm run build --prefix apps/web
    # Page should compile without errors
  </verify>
  <done>
    Registration page at /register with form validation, API integration, and redirect to /onboarding on success.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create onboarding step components</name>
  <files>
    apps/web/components/onboarding/StepIndicator.tsx
    apps/web/components/onboarding/RestaurantDetailsStep.tsx
    apps/web/components/onboarding/CategoryStep.tsx
    apps/web/components/onboarding/MenuItemStep.tsx
    apps/web/components/onboarding/QRCodeStep.tsx
    apps/web/lib/hooks/useOnboarding.ts
  </files>
  <action>
Create onboarding components following CONTEXT.md 4-step wizard:

**StepIndicator.tsx:**
- Visual progress indicator (4 circles with connecting lines)
- Current step highlighted in emerald
- Completed steps show checkmark
- Step labels: Details, Category, Menu Item, QR Code

**RestaurantDetailsStep.tsx (Step 1):**
- Form fields: Restaurant name (prefilled from registration), address, phone, logo upload (optional)
- PATCH /api/restaurants/{id}/ on submit
- Skip button available (can complete later)

**CategoryStep.tsx (Step 2):**
- Simple form: Category name (e.g., "Main Dishes", "Drinks")
- POST /api/menu/categories/ on submit
- Show success with "Category created!" feedback
- Store created category ID for next step

**MenuItemStep.tsx (Step 3):**
- Form: Item name, price (XOF integer), description (optional), photo upload (optional)
- Category dropdown (shows category from step 2, or allows selection)
- POST /api/menu/items/ on submit
- Show item preview card after creation

**QRCodeStep.tsx (Step 4):**
- Generate QR code pointing to /menu/{slug}
- Display QR code preview
- Download buttons: Small (200px), Medium (400px), Large (800px)
- "Print QR Code" button opens print dialog
- "Go to Dashboard" CTA to complete onboarding

**useOnboarding.ts hook:**
- Manage current step (1-4)
- Track completion status per step
- Store created resources (restaurant, category, item)
- Persist progress in localStorage (resume if interrupted)
- Functions: nextStep(), prevStep(), completeStep(), getProgress()

All components use Tailwind and next-intl.
  </action>
  <verify>
    ls apps/web/components/onboarding/
    # Should show: StepIndicator.tsx, RestaurantDetailsStep.tsx, CategoryStep.tsx, MenuItemStep.tsx, QRCodeStep.tsx
  </verify>
  <done>
    5 onboarding components created with proper API integration and state management.
  </done>
</task>

<task type="auto">
  <name>Task 3: Compose onboarding page and add translations</name>
  <files>
    apps/web/app/[locale]/onboarding/page.tsx
    apps/web/messages/fr.json
    apps/web/messages/en.json
  </files>
  <action>
**Create onboarding/page.tsx:**
- Protected route (redirect to /register if not authenticated)
- Use useOnboarding hook for state management
- Render StepIndicator at top
- Conditional rendering of current step component
- Navigation: Back button (except step 1), Next/Skip buttons
- On step 4 completion, redirect to /lite/dashboard

```tsx
'use client';

import { useEffect } from 'react';
import { useRouter } from 'next/navigation';
import { useAuth } from '@/lib/hooks/useAuth';
import { useOnboarding } from '@/lib/hooks/useOnboarding';
import { StepIndicator } from '@/components/onboarding/StepIndicator';
import { RestaurantDetailsStep } from '@/components/onboarding/RestaurantDetailsStep';
import { CategoryStep } from '@/components/onboarding/CategoryStep';
import { MenuItemStep } from '@/components/onboarding/MenuItemStep';
import { QRCodeStep } from '@/components/onboarding/QRCodeStep';

export default function OnboardingPage() {
  const router = useRouter();
  const { isAuthenticated, isLoading } = useAuth();
  const { currentStep, ... } = useOnboarding();

  // Redirect if not authenticated
  useEffect(() => {
    if (!isLoading && !isAuthenticated) {
      router.push('/register');
    }
  }, [isAuthenticated, isLoading, router]);

  // Render current step...
}
```

**Add translations:**
```json
"onboarding": {
  "step_indicator": {
    "step1": "Details",
    "step2": "Category",
    "step3": "Menu Item",
    "step4": "QR Code"
  },
  "details": {
    "title": "Tell us about your restaurant",
    "name": "Restaurant name",
    "address": "Address",
    "phone": "Phone",
    "logo": "Logo (optional)",
    "skip": "Skip for now",
    "next": "Next"
  },
  "category": {
    "title": "Create your first category",
    "name": "Category name",
    "placeholder": "e.g., Main Dishes, Drinks, Desserts",
    "create": "Create category",
    "created": "Category created!"
  },
  "menu_item": {
    "title": "Add your first menu item",
    "name": "Item name",
    "price": "Price (XOF)",
    "description": "Description (optional)",
    "photo": "Photo (optional)",
    "category": "Category",
    "create": "Add item",
    "created": "Item added!"
  },
  "qr_code": {
    "title": "Your QR code is ready!",
    "subtitle": "Customers can scan this code to view your menu",
    "download_small": "Small (200px)",
    "download_medium": "Medium (400px)",
    "download_large": "Large (800px)",
    "print": "Print QR Code",
    "finish": "Go to Dashboard"
  }
}
```
  </action>
  <verify>
    npm run build --prefix apps/web
    # Build should succeed
  </verify>
  <done>
    Onboarding page at /onboarding renders 4-step wizard, guides user from details to QR code download.
  </done>
</task>

</tasks>

<verification>
1. /register page renders with form
2. Registration creates account and redirects to /onboarding
3. /onboarding shows step indicator and first step
4. Can complete all 4 steps
5. Step 4 shows QR code and download buttons
6. QR code download works (generates PNG)
7. "Go to Dashboard" redirects to /lite/dashboard
8. Progress persists if page refreshed (localStorage)
</verification>

<success_criteria>
- Registration form validates and submits to API
- JWT tokens stored on successful registration
- Onboarding wizard has 4 functional steps
- Each step creates/updates resources via API
- QR code generates with correct URL (/menu/{slug})
- QR download works in 3 sizes
- User can complete full flow in under 5 minutes
</success_criteria>

<output>
After completion, create `.planning/phases/05.5-resto360-lite/05.5-03-SUMMARY.md`
</output>
